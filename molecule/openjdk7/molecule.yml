---
dependency:
    name: galaxy
driver:
    name: docker
lint:
    name: yamllint
    options:
        config-file: molecule/openjdk7/yaml-lint.yml
platforms:
    - name: CentOS7
      image: "kubecloudsas/docker-ansible-test:centos7"
      command: ${MOLECULE_DOCKER_COMMAND:-""}
      volumes:
          - /sys/fs/cgroup:/sys/fs/cgroup:ro
      privileged: true
      pre_build_image: true

    - name: Ubuntu16
      image: "kubecloudsas/docker-ansible-test:ubuntu16"
      command: ${MOLECULE_DOCKER_COMMAND:-""}
      volumes:
          - /sys/fs/cgroup:/sys/fs/cgroup:ro
      privileged: true
      pre_build_image: true

    - name: Ubuntu18
      image: "kubecloudsas/docker-ansible-test:ubuntu18"
      command: ${MOLECULE_DOCKER_COMMAND:-""}
      volumes:
          - /sys/fs/cgroup:/sys/fs/cgroup:ro
      privileged: true
      pre_build_image: true

provisioner:
    name: ansible
    lint:
        name: ansible-lint
        options:
            force-color: true
    playbooks:
        converge: ${MOLECULE_PLAYBOOK:-playbook.yml}

scenario:
    name: openjdk7
    test_sequence:
        - lint
        - dependency
        - syntax
        - create
        - prepare
        - converge
        - idempotence
        - side_effect
        - verify
        - cleanup
        - destroy
verifier:
    name: testinfra
    lint:
        name: flake8
